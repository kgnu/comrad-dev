!function(){function c(a,c){return a.getParam(c,b[c])}var a=tinymce.each,b={paste_auto_cleanup_on_paste:!0,paste_enable_default_filters:!0,paste_block_drop:!1,paste_retain_style_properties:"none",paste_strip_class_attributes:"mso",paste_remove_spans:!1,paste_remove_styles:!1,paste_remove_styles_if_webkit:!0,paste_convert_middot_lists:!0,paste_convert_headers_to_strong:!1,paste_dialog_width:"450",paste_dialog_height:"400",paste_text_use_dialog:!1,paste_text_sticky:!1,paste_text_sticky_default:!1,paste_text_notifyalways:!1,paste_text_linebreaktype:"p",paste_text_replacements:[[/\u2026/g,"..."],[/[\x93\x94\u201c\u201d]/g,'"'],[/[\x60\x91\x92\u2018\u2019]/g,"'"]]};tinymce.create("tinymce.plugins.PastePlugin",{init:function(b,d){function f(a,d){var g,f=b.dom;e.onPreProcess.dispatch(e,a),a.node=f.create("div",0,a.content),tinymce.isGecko&&(g=b.selection.getRng(!0),g.startContainer==g.endContainer&&3==g.startContainer.nodeType&&1===a.node.childNodes.length&&/^(p|h[1-6]|pre)$/i.test(a.node.firstChild.nodeName)&&a.content.indexOf("__MCE_ITEM__")===-1&&f.remove(a.node.firstChild,!0)),e.onPostProcess.dispatch(e,a),a.content=b.serializer.serialize(a.node,{getInner:1,forced_root_block:""}),!d&&b.pasteAsPlainText?(e._insertPlainText(b,f,a.content),c(b,"paste_text_sticky")||(b.pasteAsPlainText=!1,b.controlManager.setActive("pastetext",!1))):e._insert(a.content)}function g(c){function n(a){a.preventDefault()}var d,e,g,h,l,m,i=b.selection,j=b.dom,k=b.getBody();if((c.clipboardData||j.doc.dataTransfer)&&(m=(c.clipboardData||j.doc.dataTransfer).getData("Text"),b.pasteAsPlainText))return c.preventDefault(),void f({content:m.replace(/\r?\n/g,"<br />")});if(!j.get("_mcePaste"))return d=j.add(k,"div",{id:"_mcePaste",class:"mcePaste","data-mce-bogus":"1"},"\ufeff\ufeff"),l=k!=b.getDoc().body?j.getPos(b.selection.getStart(),k).y:k.scrollTop+j.getViewPort(b.getWin()).y,j.setStyles(d,{position:"absolute",left:tinymce.isGecko?-40:0,top:l-25,width:1,height:1,overflow:"hidden"}),tinymce.isIE?(h=i.getRng(),g=j.doc.body.createTextRange(),g.moveToElementText(d),g.execCommand("Paste"),j.remove(d),"\ufeff\ufeff"===d.innerHTML?(b.execCommand("mcePasteWord"),void c.preventDefault()):(i.setRng(h),i.setContent(""),setTimeout(function(){f({content:d.innerHTML})},0),tinymce.dom.Event.cancel(c))):(j.bind(b.getDoc(),"mousedown",n),j.bind(b.getDoc(),"keydown",n),e=b.selection.getRng(),d=d.firstChild,g=b.getDoc().createRange(),g.setStart(d,0),g.setEnd(d,2),i.setRng(g),window.setTimeout(function(){var d,c="";j.select("div.mcePaste > div.mcePaste").length?c="<p>"+j.encode(m).replace(/\r?\n\r?\n/g,"</p><p>").replace(/\r?\n/g,"<br />")+"</p>":(d=j.select("div.mcePaste"),a(d,function(b){var d=b.firstChild;d&&"DIV"==d.nodeName&&d.style.marginTop&&d.style.backgroundColor&&j.remove(d,1),a(j.select("span.Apple-style-span",b),function(a){j.remove(a,1)}),a(j.select("br[data-mce-bogus]",b),function(a){j.remove(a)}),"mcePaste"!=b.parentNode.className&&(c+=b.innerHTML)})),a(j.select("div.mcePaste"),function(a){j.remove(a)}),e&&i.setRng(e),f({content:c}),j.unbind(b.getDoc(),"mousedown",n),j.unbind(b.getDoc(),"keydown",n)},0),void 0)}var e=this;e.editor=b,e.url=d,e.onPreProcess=new tinymce.util.Dispatcher(e),e.onPostProcess=new tinymce.util.Dispatcher(e),e.onPreProcess.add(e._preProcess),e.onPostProcess.add(e._postProcess),e.onPreProcess.add(function(a,c){b.execCallback("paste_preprocess",a,c)}),e.onPostProcess.add(function(a,c){b.execCallback("paste_postprocess",a,c)}),b.onKeyDown.addToTop(function(a,b){if((tinymce.isMac?b.metaKey:b.ctrlKey)&&86==b.keyCode||b.shiftKey&&45==b.keyCode)return!1}),b.pasteAsPlainText=c(b,"paste_text_sticky_default"),b.addCommand("mceInsertClipboardContent",function(a,b){f(b,!0)}),c(b,"paste_text_use_dialog")||b.addCommand("mcePasteText",function(a,d){var e=tinymce.util.Cookie;b.pasteAsPlainText=!b.pasteAsPlainText,b.controlManager.setActive("pastetext",b.pasteAsPlainText),b.pasteAsPlainText&&!e.get("tinymcePasteText")&&(c(b,"paste_text_sticky")?b.windowManager.alert(b.translate("paste.plaintext_mode_sticky")):b.windowManager.alert(b.translate("paste.plaintext_mode_sticky")),c(b,"paste_text_notifyalways")||e.set("tinymcePasteText","1",new Date((new Date).getFullYear()+1,12,31)))}),b.addButton("pastetext",{title:"paste.paste_text_desc",cmd:"mcePasteText"}),b.addButton("selectall",{title:"paste.selectall_desc",cmd:"selectall"}),c(b,"paste_auto_cleanup_on_paste")&&(tinymce.isOpera||/Firefox\/2/.test(navigator.userAgent)?b.onKeyDown.addToTop(function(a,b){((tinymce.isMac?b.metaKey:b.ctrlKey)&&86==b.keyCode||b.shiftKey&&45==b.keyCode)&&g(b)}):b.onPaste.addToTop(function(a,b){return g(b)})),b.onInit.add(function(){b.controlManager.setActive("pastetext",b.pasteAsPlainText),c(b,"paste_block_drop")&&b.dom.bind(b.getBody(),["dragend","dragover","draggesture","dragdrop","drop","drag"],function(a){return a.preventDefault(),a.stopPropagation(),!1})}),e._legacySupport()},getInfo:function(){return{longname:"Paste text/word",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/paste",version:tinymce.majorVersion+"."+tinymce.minorVersion}},_preProcess:function(b,d){function l(b){a(b,function(a){f=a.constructor==RegExp?f.replace(a,""):f.replace(a[0],a[1])})}function m(a,b){if("all"===k)return"";var c=g(h(b.replace(/^(["'])(.*)\1$/,"$2")," "),function(a){return/^(?!mso)/i.test(a)});return c.length?' class="'+c.join(" ")+'"':""}var j,k,e=this.editor,f=d.content,g=tinymce.grep,h=tinymce.explode,i=tinymce.trim;if(0!=e.settings.paste_enable_default_filters){if(tinymce.isIE&&document.documentMode>=9&&(l([[/(?:<br>&nbsp;[\s\r\n]+|<br>)*(<\/?(h[1-6r]|p|div|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|caption|blockquote|center|dl|dt|dd|dir|fieldset)[^>]*>)(?:<br>&nbsp;[\s\r\n]+|<br>)*/g,"$1"]]),l([[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])),/class="?Mso|style="[^"]*\bmso-|w:WordDocument/i.test(f)||d.wordContent){d.wordContent=!0,l([/^\s*(&nbsp;)+/gi,/(&nbsp;|<br[^>]*>)+\s*$/gi]),c(e,"paste_convert_headers_to_strong")&&(f=f.replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>")),c(e,"paste_convert_middot_lists")&&l([[/<!--\[if !supportLists\]-->/gi,"$&__MCE_ITEM__"],[/(<span[^>]+(?:mso-list:|:\s*symbol)[^>]+>)/gi,"$1__MCE_ITEM__"],[/(<p[^>]+(?:MsoListParagraph)[^>]+>)/gi,"$1__MCE_ITEM__"]]),l([/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi," "]]);do j=f.length,f=f.replace(/(<[a-z][^>]*\s)(?:id|name|language|type|on\w+|\w+:\w+)=(?:"[^"]*"|\w+)\s?/gi,"$1");while(j!=f.length);0==c(e,"paste_retain_style_properties").replace(/^none$/i,"").length?f=f.replace(/<\/?span[^>]*>/gi,""):l([[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(a,b){return b.length>0?b.replace(/./," ").slice(Math.floor(b.length/2)).split("").join(" "):""}],[/(<[a-z][^>]*)\sstyle="([^"]*)"/gi,function(b,c,d){var e=[],f=0,g=h(i(d).replace(/&quot;/gi,"'"),";");return a(g,function(a){function g(a){return a+("0"!==a&&/\d$/.test(a))?"px":""}var b,c,d=h(a,":");if(2==d.length){switch(b=d[0].toLowerCase(),c=d[1].toLowerCase(),b){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-table-layout-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":return void(e[f++]=b.replace(/^mso-|-alt$/g,"")+":"+g(c));case"horiz-align":return void(e[f++]="text-align:"+c);case"vert-align":return void(e[f++]="vertical-align:"+c);case"font-color":case"mso-foreground":return void(e[f++]="color:"+c);case"mso-background":case"mso-highlight":return void(e[f++]="background:"+c);case"mso-default-height":return void(e[f++]="min-height:"+g(c));case"mso-default-width":return void(e[f++]="min-width:"+g(c));case"mso-padding-between-alt":return void(e[f++]="border-collapse:separate;border-spacing:"+g(c));case"text-line-through":return void("single"!=c&&"double"!=c||(e[f++]="text-decoration:line-through"));case"mso-zero-height":return void("yes"==c&&(e[f++]="display:none"))}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?!align|decor|indent|trans)|top-bar|version|vnd|word-break)/.test(b))return;e[f++]=b+":"+d[1]}}),f>0?c+' style="'+e.join(";")+'"':c}]])}c(e,"paste_convert_headers_to_strong")&&l([[/<h[1-6][^>]*>/gi,"<p><strong>"],[/<\/h[1-6][^>]*>/gi,"</strong></p>"]]),l([[/Version:[\d.]+\nStartHTML:\d+\nEndHTML:\d+\nStartFragment:\d+\nEndFragment:\d+/gi,""]]),k=c(e,"paste_strip_class_attributes"),"none"!==k&&(f=f.replace(/ class="([^"]+)"/gi,m),f=f.replace(/ class=([\-\w]+)/gi,m)),c(e,"paste_remove_spans")&&(f=f.replace(/<\/?span[^>]*>/gi,"")),d.content=f}},_postProcess:function(b,d){var h,e=this,f=e.editor,g=f.dom;0!=f.settings.paste_enable_default_filters&&(d.wordContent&&(a(g.select("a",d.node),function(a){a.href&&a.href.indexOf("#_Toc")==-1||g.remove(a,1)}),c(f,"paste_convert_middot_lists")&&e._convertLists(b,d),h=c(f,"paste_retain_style_properties"),tinymce.is(h,"string")&&"all"!==h&&"*"!==h&&(h=tinymce.explode(h.replace(/^none$/i,"")),a(g.select("*",d.node),function(a){var d,e,f,b={},c=0;if(h)for(d=0;d<h.length;d++)e=h[d],f=g.getStyle(a,e),f&&(b[e]=f,c++);g.setAttrib(a,"style",""),h&&c>0?g.setStyles(a,b):"SPAN"!=a.nodeName||a.className||g.remove(a,!0)}))),c(f,"paste_remove_styles")||c(f,"paste_remove_styles_if_webkit")&&tinymce.isWebKit?a(g.select("*[style]",d.node),function(a){a.removeAttribute("style"),a.removeAttribute("data-mce-style")}):tinymce.isWebKit&&a(g.select("*",d.node),function(a){a.removeAttribute("data-mce-style")}))},_convertLists:function(b,c){var e,f,h,j,k,d=b.editor.dom,g=-1,i=[];a(d.select("p",c.node),function(b){var c,l,m,n,o,k="";for(c=b.firstChild;c&&3==c.nodeType;c=c.nextSibling)k+=c.nodeValue;k=b.innerHTML.replace(/<\/?\w+[^>]*>/gi,"").replace(/&nbsp;/g," "),/^(__MCE_ITEM__)+[\u2022\u00b7\u00a7\u00d8o\u25CF]\s*\u00a0*/.test(k)&&(l="ul"),/^__MCE_ITEM__\s*\w+\.\s*\u00a0+/.test(k)&&(l="ol"),l?(h=parseFloat(b.style.marginLeft||0),h>g&&i.push(h),e&&l==j?h>g?e=f.appendChild(d.create(l)):h<g&&(n=tinymce.inArray(i,h),o=d.getParents(e.parentNode,l),e=o[o.length-1-n]||e):(e=d.create(l),d.insertAfter(e,b)),a(d.select("span",b),function(a){var b=a.innerHTML.replace(/<\/?\w+[^>]*>/gi,"");"ul"==l&&/^__MCE_ITEM__[\u2022\u00b7\u00a7\u00d8o\u25CF]/.test(b)?d.remove(a):/^__MCE_ITEM__[\s\S]*\w+\.(&nbsp;|\u00a0)*\s*/.test(b)&&d.remove(a)}),m=b.innerHTML,m="ul"==l?b.innerHTML.replace(/__MCE_ITEM__/g,"").replace(/^[\u2022\u00b7\u00a7\u00d8o\u25CF]\s*(&nbsp;|\u00a0)+\s*/,""):b.innerHTML.replace(/__MCE_ITEM__/g,"").replace(/^\s*\w+\.(&nbsp;|\u00a0)+\s*/,""),f=e.appendChild(d.create("li",0,m)),d.remove(b),g=h,j=l):e=g=0}),k=c.node.innerHTML,k.indexOf("__MCE_ITEM__")!=-1&&(c.node.innerHTML=k.replace(/__MCE_ITEM__/g,""))},_insert:function(a,b){var c=this.editor,d=c.selection.getRng();c.selection.isCollapsed()||d.startContainer==d.endContainer||c.getDoc().execCommand("Delete",!1,null),c.execCommand("mceInsertRawHTML",!1,a,{skip_undo:b})},_insertPlainText:function(b,d,e){function u(b){a(b,function(a){e=a.constructor==RegExp?e.replace(a,""):e.replace(a[0],a[1])})}var f,g,h,i,j,k,l,m,n=b.getWin(),o=b.getDoc(),p=b.selection,q=tinymce.is,s=(tinymce.inArray,c(b,"paste_text_linebreaktype")),t=c(b,"paste_text_replacements");if("string"==typeof e&&e.length>0){if(u(/<(?:p|br|h[1-6]|ul|ol|dl|table|t[rdh]|div|blockquote|fieldset|pre|address|center)[^>]*>/i.test(e)?[/[\n\r]+/g]:[/\r+/g]),u([[/<\/(?:p|h[1-6]|ul|ol|dl|table|div|blockquote|fieldset|pre|address|center)>/gi,"\n\n"],[/<br[^>]*>|<\/tr>/gi,"\n"],[/<\/t[dh]>\s*<t[dh][^>]*>/gi,"\t"],/<[a-z!\/?][^>]*>/gi,[/&nbsp;/gi," "],[/(?:(?!\n)\s)*(\n+)(?:(?!\n)\s)*/gi,"$1"],[/\n{3,}/g,"\n\n"],/^\s+|\s+$/g]),e=d.decode(tinymce.html.Entities.encodeRaw(e)),p.isCollapsed()||o.execCommand("Delete",!1,null),q(t,"array")||q(t,"array")?u(t):q(t,"string")&&u(new RegExp(t,"gi")),u("none"==s?[[/\n+/g," "]]:"br"==s?[[/\n/g,"<br />"]]:[/^\s+|\s+$/g,[/\n\n/g,"</p><p>"],[/\n/g,"<br />"]]),(h=e.indexOf("</p><p>"))!=-1){i=e.lastIndexOf("</p><p>"),j=p.getNode(),k=[];do if(1==j.nodeType){if("TD"==j.nodeName||"BODY"==j.nodeName)break;k[k.length]=j}while(j=j.parentNode);if(k.length>0){for(l=e.substring(0,h),m="",f=0,g=k.length;f<g;f++)l+="</"+k[f].nodeName.toLowerCase()+">",m+="<"+k[k.length-f-1].nodeName.toLowerCase()+">";e=h==i?l+m+e.substring(h+7):l+e.substring(h+4,i+4)+m+e.substring(i+7)}}b.execCommand("mceInsertRawHTML",!1,e+'<span id="_plain_text_marker">&nbsp;</span>'),window.setTimeout(function(){var b,c,e,f,a=d.get("_plain_text_marker");p.select(a,!1),o.execCommand("Delete",!1,null),a=null,b=p.getStart(),c=d.getViewPort(n),e=d.getPos(b).y,f=b.clientHeight,(e<c.y||e+f>c.y+c.h)&&(o.body.scrollTop=e<c.y?e:e-c.h+25)},0)}},_legacySupport:function(){var a=this,b=a.editor;b.addCommand("mcePasteWord",function(){b.windowManager.open({file:a.url+"/pasteword.htm",width:parseInt(c(b,"paste_dialog_width")),height:parseInt(c(b,"paste_dialog_height")),inline:1})}),c(b,"paste_text_use_dialog")&&b.addCommand("mcePasteText",function(){b.windowManager.open({file:a.url+"/pastetext.htm",width:parseInt(c(b,"paste_dialog_width")),height:parseInt(c(b,"paste_dialog_height")),inline:1})}),b.addButton("pasteword",{title:"paste.paste_word_desc",cmd:"mcePasteWord"})}}),tinymce.PluginManager.add("paste",tinymce.plugins.PastePlugin)}();